#Author: Nick

# diffusion_mri

# Overview

Diffusion MRI uses the physics of water molecule movement to produce a model of the structural orientation of fibers in the brain's [[white_matter]]. This is accomplished through the use of the scanner's gradient magnets, which impose a slight spatial gradient on the main magnet's field in the X, Y, and Z directions. 

Post-acquisition you must produce a model of the diffusion properties across all obtained directions. This is referred to as "reconstruction" and there are serveral methods to do this

After reconstructing the input scans you're able to move on to the [[tractography]] stage, in which you capture the brain's major white matter [[tracts]]. From there you can obtain some tract-wise measure such as [[FA]], [[QA]], or [[MD]]. 


# Sequences: 

In diffusion MRI you need to produce a 3-dimensional volume of the brain for every x,y,z direction you collect. In addition to specifying the relative x,y,z gradient strengths you also specify the sensitivity to diffusion. For whatever reason "b" is used as a prefix to denote diffusion parameters with the relative x,y,z strengths being referred to as the b-vector or [[bvec]] (the vector of relative [x,y,z] from 0-1) and the sensitivity being referred to as the b-value [[bval]]. When the b-value is equal to zero the scan is completely insensitive to diffusion in any direction. For purposes of calibration, baseline, and reference it is necessary to collect at least 1 (usually multiple) scans with b=0 (referred to as b-0 scans).

Each b-value b-vector pair is referred to as "a direction" in acquisition speak and again, represents one full 3-dimensional volume of the brain. A common but mediocre quality acquisition sequence is to collect 64 "directions", usually done with only a single b-value, often around 1000 (excepting of course the b=0 volumes). Other more intense acquisition sequences might get up to thousands of directions and multiple b-values. When multiple b-values are used it is referred to as "multi-shell"

# Reconstruction: 

After acquiring the images from the scanner and converting from [[DICOM]] to [[NIFTI]] your image data is effectively a 4-dimensional matrix (with one 3-dimensional brain volume for each direction). In order to appropriately combine each direction-sensitive volume into one 3-dimensional image representing voxel-wise diffusion one must perform "reconstruction". Reconstruction takes this 4d matrix as input and outputs a 3d matrix with some mathematical diffusion model as the element in each voxel.

There are many methods to reconstruct and each produce differing voxel-wise diffusion models. The most common you'll hear about are:
- [[DTI]]
- [[DSI]]
- [[QSDR]]

# File Formats
Directly from the scanner you get a mess of slice-wise [[DICOM]] files. You then convert this into one 4d [[NIFTI]] file. You additionally have some "meta-data" files that tell you what the b-vectors and b-values were for each volume. These are both tab-deliminated text files kept in the same folder as the image files and are given the apt file extensions of [[bvec]] and [[bval]] respectively. Sometimes these two files are consolidated into a single joint file called the btable. If you have a btable do not worry about locating your bvec or bval files as it contains all of that information

The nifti/.nii file is pre-reconstruction however and must be placed into a model to be properly analyzed. In the program we use most frequently ([[DSI-DSI-studio]]) the .nii, bval, and bvec are packaged together into a .src (source?) file for convenience then after running reconstruction you obtain a .fib file which can be opened for tractography and used to generate tracts in the brain. Those tracts you generate can be saved and are given a .trk extension. A quick video covering this process (with eurobeat? bgm) can be found here: https://www.youtube.com/watch?v=iuBtgGLohsg


TODO 


[//begin]: # "Autogenerated link references for markdown compatibility"
[white_matter]: ../white_matter "white_matter"
[tractography]: tractography "tractography"
[tracts]: tracts "tracts"
[FA]: FA "FA"
[QA]: QA "QA"
[MD]: MD "MD"
[bvec]: bvec "bvec"
[bval]: bval "bval"
[DICOM]: DICOM "DICOM"
[NIFTI]: NIFTI "NIFTI"
[DTI]: DTI "DTI"
[DSI]: DSI "DSI"
[QSDR]: QSDR "QSDR"
[//end]: # "Autogenerated link references"